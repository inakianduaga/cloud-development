# Cloud development authentication parametrized container

description "Cloud development authentication proxy docker container daemon"
instance $CONTAINER_PORT/$AUTHENTICATION_CONFIG_PATH/$PROXY_PORT/$CONTAINER_NAME

console log
respawn

script

  function getDockerBridgeIp()
  {
      echo $(ip route | awk '/docker0/ { print $NF }')
  }

  exec docker run \
      --rm
      -p $CONTAINER_PORT:8085 \
      --env-file $AUTHENTICATION_CONFIG_PATH \
      -e DOORMAN_PROXY_HOST=$(getDockerBridgeIp) \
      -e DOORMAN_PROXY_PORT=$PROXY_PORT \
      --name $CONTAINER_NAME \
      cloud-authentication

end script

